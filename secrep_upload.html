<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neues Rezept - Knuffis Rezepte</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: 'Fredoka', sans-serif; 
            background-color: #0f172a; 
            color: #e2e8f0; 
        }
        textarea, input[type="text"], input[type="email"], select { 
            background: #1e293b; 
            color: #f8fafc;
            transition: all 0.3s;
        }
        textarea:focus, input:focus, select:focus { 
            background: #334155; 
            outline: 2px dashed #FF9F1C; 
        }
        ::placeholder { color: #64748b; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        
        <div class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-orange-500 mb-2">Rezept Einsenden üßë‚Äçüç≥</h1>
            <p class="font-bold text-gray-400">Tippe dein Rezept direkt in die Karte! Es sieht sp√§ter (fast) genau so aus.</p>
            <p class="text-sm text-gray-300 mt-4 bg-gray-800 inline-block px-4 py-1 rounded-full border border-gray-700">
                Alle Felder mit einem <span class="text-orange-500 font-bold text-lg">*</span> sind Pflichtfelder.
            </p>
        </div>

        <form action="https://formsubmit.co/lars.krahnen@gmail.com" method="POST" enctype="multipart/form-data" onsubmit="baueCodeZusammen()" class="bg-gray-800 rounded-[2rem] border-4 border-black shadow-[8px_8px_0px_0px_#000000] overflow-hidden">
            
            <input type="hidden" name="_captcha" value="false">
            <input type="hidden" name="_subject" value="Neues Rezept f√ºr Knuffi!">
            <input type="hidden" name="FUEGE_DAS_IN_DIE_REZEPTE_JS_EIN" id="fertiger_code">

            <div class="py-10 bg-gray-900 border-b-4 border-black flex flex-col items-center justify-center relative px-4 cursor-pointer hover:bg-gray-950 transition" onclick="document.getElementById('i_bild_upload').click()">
                <span class="text-5xl mb-3">üì∏</span>
                <p class="font-bold text-gray-300 text-center text-lg mb-1">Klicke hier, um ein Rezeptbild hochzuladen</p>
                <p class="text-sm font-normal text-gray-400 text-center max-w-lg mb-4">
                    (Optional, aber erw√ºnscht! Rezepte mit eigenem Bild bekommen Priorit√§t beim Hinzuf√ºgen auf die Seite)
                </p>
                
                <div class="bg-red-900/30 border border-red-500/50 rounded-xl px-4 py-2 max-w-lg text-center">
                    <p class="text-xs text-red-400 font-bold">
                        ‚ö†Ô∏è Achtung Copyright: Bitte nutze nur DEINE EIGENEN Fotos! Lade keine fremden Bilder von Chefkoch, HelloFresh oder Google hoch.
                    </p>
                </div>

                <input type="file" id="i_bild_upload" name="attachment" accept="image/jpeg, image/png, image/webp" class="hidden" onchange="zeigeDateinamen(this)">
                <p id="dateiname_anzeige" class="text-sm text-orange-500 font-bold mt-4 hidden"></p>
            </div>

            <div class="p-6 md:p-10">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 bg-gray-900 p-4 rounded-2xl border-2 border-gray-700">
                    <div>
                        <label class="block font-bold text-sm text-gray-400 mb-1">Dein Name (Autor) <span class="text-orange-500">*</span></label>
                        <input type="text" id="i_autor" name="autor" required class="w-full border-2 border-gray-600 p-2 rounded-xl focus:border-orange-500" placeholder="Wie sollen wir dich nennen?">
                    </div>
                    <div>
                        <label class="block font-bold text-sm text-gray-400 mb-1">Deine E-Mail <span class="text-gray-500 font-normal">(Optional, f√ºr R√ºckfragen)</span></label>
                        <input type="email" name="email" class="w-full border-2 border-gray-600 p-2 rounded-xl focus:border-orange-500" placeholder="max@muster.de">
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block font-bold text-xs text-orange-500 uppercase tracking-wide mb-1">Rezept-Titel *</label>
                    <input type="text" id="i_titel" required class="w-full text-3xl md:text-5xl font-extrabold text-white p-2 border-b-4 border-dashed border-gray-600 bg-transparent focus:border-orange-500" placeholder="z.B. Omas Apfelkuchen">
                </div>

                <div class="flex flex-wrap gap-4 mb-10 border-t-2 border-b-2 border-gray-700 py-4">
                    <div class="flex-1 min-w-[120px]">
                        <label class="block font-bold text-xs text-gray-400 uppercase tracking-wide">Zeitaufwand <span class="text-orange-500">*</span></label>
                        <input type="text" id="i_zeit" required class="w-full font-bold text-lg p-2 rounded-xl border border-gray-600" placeholder="z.B. 20 Min.">
                    </div>
                    <div class="flex-1 min-w-[120px]">
                        <label class="block font-bold text-xs text-gray-400 uppercase tracking-wide">Portionen <span class="text-orange-500">*</span></label>
                        <input type="text" id="i_portionen" required class="w-full font-bold text-lg p-2 rounded-xl border border-gray-600" placeholder="z.B. 4 Portionen">
                    </div>
                    
                    <div class="flex-1 min-w-[120px]">
                        <label class="block font-bold text-xs text-gray-400 uppercase tracking-wide">Kategorie <span class="text-orange-500">*</span></label>
                        <select id="i_kategorie" required class="w-full font-bold text-lg p-2 rounded-xl border border-gray-600 cursor-pointer appearance-none">
                            <option value="" disabled selected>Bitte w√§hlen...</option>
                            <option value="Hauptgericht">Hauptgericht</option>
                            <option value="Hauptgericht, Schnell">Hauptgericht, Schnell</option>
                            <option value="Dessert">Dessert</option>
                            <option value="Vegetarisch">Vegetarisch</option>
                            <option value="Backen">Backen</option>
                            <option value="Fr√ºhst√ºck">Fr√ºhst√ºck</option>
                        </select>
                    </div>

                    <div class="flex-1 min-w-[120px]">
                        <label class="block font-bold text-xs text-gray-400 uppercase tracking-wide">Inspiration <span class="text-gray-500 font-normal">(Optional)</span></label>
                        <input type="text" id="i_inspiration" class="w-full font-bold text-lg p-2 rounded-xl border border-gray-600" placeholder="z.B. Von Mama">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-12 gap-10">
                    <div class="md:col-span-4 bg-gray-900 p-6 rounded-2xl border-4 border-black h-fit shadow-[4px_4px_0px_0px_#000000]">
                        <h2 class="text-2xl font-extrabold mb-2 text-white flex items-center gap-2">üõí Zutaten <span class="text-orange-500">*</span></h2>
                        <p class="text-xs text-gray-400 font-bold mb-4">Einfach untereinander schreiben:</p>
                        <textarea id="i_zutaten" required rows="10" class="w-full resize-none font-medium leading-relaxed p-3 border-2 border-gray-700 rounded-xl" placeholder="500g Hackfleisch&#10;1 Zwiebel&#10;Salz & Pfeffer"></textarea>
                    </div>

                    <div class="md:col-span-8">
                        <h2 class="text-3xl font-extrabold mb-4 text-white flex items-center gap-2">üë®‚Äçüç≥ Zubereitung <span class="text-orange-500">*</span></h2>
                        <div class="bg-blue-900 border-2 border-blue-700 text-blue-200 rounded-xl p-3 mb-4 text-sm font-medium">
                            <strong>Tipp:</strong> Wenn du deinem Schritt einen Titel geben willst, nutze einen Doppelpunkt! <br>
                            <em>Beispiel:</em> <strong>Anbraten:</strong> Das Fleisch in die Pfanne werfen...
                        </div>
                        <textarea id="i_zubereitung" required rows="12" class="w-full resize-none font-medium leading-relaxed p-4 border-2 border-gray-700 rounded-2xl" placeholder="Vorbereitung: Den Ofen auf 200 Grad vorheizen.&#10;&#10;Anbraten: Die Zwiebeln w√ºrfeln und in der Pfanne glasig d√ºnsten..."></textarea>
                    </div>
                </div>

                <div class="mt-12 text-center">
                    <button type="submit" class="bg-[#FF9F1C] text-gray-900 px-10 py-4 rounded-xl font-extrabold text-2xl border-4 border-black shadow-[6px_6px_0px_0px_#000000] hover:shadow-none hover:translate-x-[6px] hover:translate-y-[6px] transition">
                        üöÄ Rezept an Knuffi senden
                    </button>
                </div>

            </div>
        </form>
    </div>

    <script>
        function zeigeDateinamen(input) {
            const anzeige = document.getElementById('dateiname_anzeige');
            if (input.files && input.files[0]) {
                anzeige.innerText = "Ausgew√§hltes Bild: " + input.files[0].name;
                anzeige.classList.remove('hidden');
            }
        }

        function baueCodeZusammen() {
            const titel = document.getElementById('i_titel').value.trim();
            const zeit = document.getElementById('i_zeit').value.trim();
            const portionen = document.getElementById('i_portionen').value.trim();
            const kategorie = document.getElementById('i_kategorie').value;
            const autor = document.getElementById('i_autor').value.trim();
            const inspiration = document.getElementById('i_inspiration').value.trim();
            
            let id = titel.toLowerCase().replace(/[^a-z0-9√§√∂√º√ü]+/g, '_').replace(/(^_|_$)/g, '');
            if(!id) id = "neues_rezept";

            const bild = "bilder/" + id + ".jpg";
            const datum = new Date().toLocaleDateString('de-DE', {day: '2-digit', month: '2-digit', year: 'numeric'});

            const zutatenRaw = document.getElementById('i_zutaten').value.split('\n').filter(z => z.trim() !== '');
            let zutatenString = '';
            zutatenRaw.forEach((z, i) => {
                zutatenString += `            "${z.trim()}"${i < zutatenRaw.length - 1 ? ',' : ''}\n`;
            });

            const zubereitungRaw = document.getElementById('i_zubereitung').value.split('\n').filter(s => s.trim() !== '');
            let zubereitungString = '';
            let stepCount = 1;
            
            zubereitungRaw.forEach((step, i) => {
                let stepTitle = `Schritt ${stepCount}`;
                let stepText = step.trim();
                
                if(stepText.includes(':')) {
                    const firstColonIndex = stepText.indexOf(':');
                    stepTitle = stepText.substring(0, firstColonIndex).trim();
                    stepText = stepText.substring(firstColonIndex + 1).trim();
                }
                
                zubereitungString += `            { \n                titel: "${stepTitle}", \n                text: "${stepText}" \n            }${i < zubereitungRaw.length - 1 ? ',' : ''}\n`;
                stepCount++;
            });

            const finalCode = `
    "${id}": {
        titel: "${titel}",
        bild: "${bild}",
        zeit: "${zeit}",
        portionen: "${portionen}",
        kategorie: "${kategorie}",
        autor: "${autor}",
        datum: "${datum}",
        inspiration: "${inspiration}",
        zutaten: [
${zutatenString}        ],
        zubereitung: [
${zubereitungString}        ]
    },`;

            document.getElementById('fertiger_code').value = finalCode;
        }
    </script>
</body>
</html>
